<!-- AJAX - Asynchronous Javascript AND XML - allow us to communicate with remote web
servers in an Asynchronous way, with ajax call we can request server for data,
behind the page. -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ajax</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <style type="text/css">
      .card {
        opacity: 0;
        transition: opacity 4s;
      }
    </style>
  </head>
  <body>
    <div class="card mx-auto w-25"></div>
    country: <input type="text" id="cn" value="australia" />
    <button id="btn">Load</button>

    <script lang="Javascript">
      const btn = document.querySelector("#btn");
      const box = document.querySelector(".card");
      const cn = document.querySelector("#cn");

      btn.addEventListener("click",()=>{
        box.innerHTML = "";
        const country = cn.value;
          const req = new XMLHttpRequest(); // request object
          req.open("get","https://restcountries.com/v3.1/name/"+country);// request opened
          req.send(); // send request, once completed load event will be called
          req.addEventListener("load",function(){
            // console.log(this);
            // console.log(JSON.parse(this.responseText));
            const res = JSON.parse(this.responseText)[0];
            const flag = res.flags.png;
            console.log(res);
            const html = `<img src=${flag} >
            <div class='card-body'>
            <div class='card-title'><b>${res.name.common}</b></div>
                <ul>
                    <li>Population: ${res.population}</li>
                    <li>Capital: ${res.capital[0]}</li>
                    <li>Currency: ${Object.keys(res.currencies)[0]}</li>
                </ul>

            </div>
            `;
            box.insertAdjacentHTML('beforeend', html);
            box.style.opacity = 1;

          });
      });
    </script>
  </body>
</html>
